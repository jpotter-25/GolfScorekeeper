Golf 9 Card Game - Online Multiplayer System Design & Functionality
I. Core Architecture
Authoritative server + dumb clients: Server validates all moves, owns the clock, and is the single source of truth. Clients render + send intents.
Optimistic UI + server reconciliation. Client animates local move; server echoes the authoritative result. If mismatch, client snaps to server state.
Time sync. Server timestamps all actions; clients display serverTs based timers (e.g., turn timeout).

A. Real-Time Communication
•	Any lobby setting change, players leave or join a room, player count 1/X players, Room gets purged, delisted, or listed – should all be visually and logically updated as applicable.
o	Examples:
	If the lobby host changes the player settings from 4 players to 2 players, then that should be reflected visually, in real time,  for all players in that room. If that room is currently not full, it will also be displayed in the “Active Lobbies” section, the lobby that had the player setting change, should also visually reflect, in real time, how many players are currently in that lobby for visual awareness to players looking for a room to join.
	If a lobby is full, it should visually be delisted from the “active lobbies” section in real-time.
	If I lobby was full but now has empty slots because a player left the lobby, it should be listed back onto the “Active Lobbies” section in real-time.
	If no players are in a room, that room should be purged and delisted in real time.
II. Lobby & Room System
A. Main Multiplayer Hub
1.	Two sections:
•	Active Lobbies (public rooms waiting for players)
1.	Displayed by room cards.
•	Private Lobbies (private rooms waiting for players)
1.	Can only be joined if provided with password set by host, or from a direct friend invite.
2.	Room Display Cards:
•	Room name and code
•	Host indicator with crown icon
•	Player count (X/Y format)
•	Bet amount (if applicable)
•	Join button when space available
B. Room Creation
1.	Host privileges: First player becomes host
2.	Configurable settings:
•	Rounds: 5 or 9
•	Max players: 2-4
•	Bet amount: 0-100 coins
•	Private/Public toggle
1.	If private lobby, it shows as locked on the room card and can only be joined if provided with password set by host, or from a direct friend invite.
3.	Auto-generated 6-character room codes
4.	Real-time settings sync
C. Room States
•	Waiting: Players joining, can modify settings
•	Active: Game in progress, no new players
•	Finished: Game complete, showing results
III. Game Flow & Transitions
A. Lobby Phase
1.	Player Management:
•	Real-time player join/leave notifications
•	Ready/Not Ready toggle system
•	Visual ready indicators (green checkmarks)
•	Connected player avatars and names
2.	Auto-Start Mechanism:
•	Triggers when all players mark ready
•	Broadcasts game start to all participants
•	Synchronizes initial game state
B. Game Initialization
1.	Transition from lobby to game:
•	Lobby UI hides automatically
•	Game state initialization
C. In-Game Features
1.	Turn-based gameplay:
•	Current player indicator
•	Action validation before broadcast
•	Real-time card movements
•	Score updates after each round
2.	Connection resilience:
•	Rejoin capability if disconnected
•	"Connection lost" modal with retry
IV. Host System Integration
A. Host Privileges
•	Special visual indicator (golden crown icon)
•	Deterministic host migration. Next host = lowest join order still connected; migration triggers a room-wide HOST_CHANGED event.V. Edge Cases & Business Rules
A. Room Management
•	Auto-delete empty rooms after all players leave
•	Host migration if original host disconnects
•	Maximum 4 players per room enforced
•	Duplicate join prevention via database constraints
B. Game Start Conditions
•	Minimum 2 players required
•	All players must be ready for auto-start
•	Settings locked once game begins
C. Disconnection Handling
•	5-minute timeout for reconnection
•	AI auto takeover for disconnected players
•	Game always continues once started, until all rounds are played.
VI. Future Enhancements (Planned)
A. Tournament Mode
•	Bracket system
•	Scheduled tournaments
•	Entry fees and prize pools
B. Friend System
•	Friend codes for direct invites
•	Private room passwords
•	Friend list integration
C. Premium Features
•	Custom table themes
•	Animated card backs
•	Victory celebrations
•	Chat emotes
Security & Abuse Prevention
•	Rate limits & flood protection per IP/user/room.
•	Audit log (append-only) for payouts, bet changes, host transfers.
